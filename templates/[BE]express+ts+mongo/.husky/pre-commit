#!/bin/sh
# This hook script checks staged JavaScript files for linting errors using ESLint
echo "Git Hook Triggered! Running ESLint on staged files..."

# Check if ESLint is installed
if ! command -v eslint > /dev/null; then
    echo "ERROR: ESLint is not installed. Please install it with 'npm install eslint'." >&2
    exit 1
fi

# Get a list of all staged JavaScript files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep '\.js$')

if [ "$STAGED_FILES" = "" ]; then
    echo "No JavaScript files staged for commit."
    exit 0
fi

# Run ESLint on all staged JavaScript files
echo "Linting JavaScript files..."
ESLINT_ERRORS=0

for FILE in $STAGED_FILES; do
    eslint "$FILE"
    if [ $? -ne 0 ]; then
        ESLINT_ERRORS=1
    fi
done

if [ $ESLINT_ERRORS -ne 0 ]; then
    echo "--------------------------------------------------------------------"
    echo "ERROR: ESLint found errors in the staged JavaScript files." >&2
    echo "--------------------------------------------------------------------"
    echo "Please fix the ESLint errors before committing."
    exit 1
fi

echo "SUCCESS:âœ¨ All staged JavaScript files passed ESLint. Good job!! ðŸš€"
